{% extends "base.html" %}

{% block title %}{{ page.title }} - Details{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white shadow rounded-lg p-6 mt-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-2">{{ page.title }}</h2>
    <p class="text-sm text-gray-500 mb-2">
        <a href="{{ page.url }}" target="_blank" class="hover:text-blue-600 break-all">{{ page.url }}</a>
    </p>
    <p class="text-sm text-gray-500 mb-2">Saved on: {{ page.saved_at.strftime('%Y-%m-%d %H:%M:%S') }}</p>
    {% if page.saved_item_id %}
        <p class="text-sm text-gray-500 mb-2">Run ID: {{ page.saved_item_id }}</p>
    {% endif %}

    {% if extracted_content %}
        <div class="mt-6 mb-8">
            <h3 class="text-xl font-medium text-gray-700 mb-4">Processed Content</h3>
            <div class="bg-gray-50 rounded p-5 extracted-content">
                {% if extracted_content.run_id %}
                    <p class="mb-4">
                        <a href="{{ extracted_content.extraction_url }}" target="_blank" class="text-blue-600 font-medium hover:underline">
                            View Full Extraction Results on Gumloop &rarr;
                        </a>
                    </p>
                {% endif %}
                
                {% if extracted_content.message %}
                    <p class="text-gray-700 mb-4">{{ extracted_content.message }}</p>
                {% endif %}

                {% if extracted_content.content %}
                    <div class="mt-4 bg-white p-4 rounded shadow-sm">
                        <h4 class="text-lg font-medium mb-2">{{ extracted_content.content.title }}</h4>
                        <p class="text-gray-700">{{ extracted_content.content.description }}</p>
                    </div>
                {% endif %}
                
                {% if page.gumloop_data.url %}
                    <div class="mt-4 pt-4 border-t border-gray-200">
                        <p class="mb-2">
                            <a href="{{ page.gumloop_data.url }}" target="_blank" class="text-blue-600 hover:underline">
                                View Pipeline Results &rarr;
                            </a>
                        </p>
                    </div>
                {% endif %}
            </div>
        </div>
    {% endif %}

    {% if page.gumloop_data %}
        <div class="mt-6">
            <h3 class="text-lg font-medium text-gray-700 mb-2">API Response</h3>
            <div class="bg-gray-50 rounded p-3 gumloop-data">
                <pre class="text-sm text-gray-800">{{ page.gumloop_data | tojson(indent=2) }}</pre>
            </div>
        </div>
    {% else %}
        <p class="text-gray-500 mt-4">No Gumloop data available for this page.</p>
    {% endif %}

    <div class="mt-6">
        <a href="{{ url_for('main.index') }}" class="text-blue-600 hover:underline">&larr; Back to Saved Pages</a>
    </div>
</div>
{% endblock %}